<!doctype html>
<html>
	<head>
		<title>APOLLO</title>
		<style>
			#game-container {
				position: absolute;
				top:0;
				left:0;
				right: 0;
				bottom: 0;
				background-color: #111;
			}
			#game-canvas {
				position: absolute;
				z-index: -1;
			}
			#game-console {
				overflow: auto;
				position: absolute;
				color: white;
				top: 50px;
				bottom: 50px;
				left: 50px;
				right: 50px;
				//width: 90%;
				//height: 90%;
				//margin: 0;
			}
		</style>
	</head>
	<body>
		<div id="game-container">
			<pre id="game-console"></pre>
			<canvas id="game-canvas"></canvas>
		</div>
		<script src="lua.vm.js"></script>
		<script>
			function http_req(method,url,callback_success,callback_error) {
				var req = new XMLHttpRequest();

				req.onreadystatechange = function() {
					if (req.readyState==4) {
						if (req.status!=200) {
							if (typeof(callback_error)!="function") throw "Could not fetch file: "+url;
							callback_error();
						} else {
							callback_success(req.response);
						}
					}
				}
				req.open(method,url);
				req.send();
			}

			var console_element = document.getElementById("game-console");
			function console_print() {
				var should_scroll = console_element.scrollTop + console_element.clientHeight == console_element.scrollHeight;

				for(var i = 0; i < arguments.length; i++) {
					if (i>0) console_element.textContent+="\t";
					console_element.textContent += arguments[i];
				}
				console_element.textContent += "\n";

				if (should_scroll)
					console_element.scrollTop = console_element.scrollHeight - console_element.clientHeight;
			}

			var file_table;

			http_req("GET","index.json",function(data) {
				file_table= JSON.parse(data);

				http_req("GET","init.lua",L.execute.bind(L));
			});
		</script>
		<pre>
		new
		lua.vm.js:1 pairs
		lua.vm.js:1 global
		lua.vm.js:1 ipairs
		lua.vm.js:1 null
		</pre>
	</body>
</html>